<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="it=edge"
    <link rel="stylesheet" href="style.css" type="text/css">
    <title>Document</title>
  </head>

  <body>
  <h1>Geolocation</h1>
  <script>
  getData()
    async function getData(){
    const response = await fetch('/sending_data')
    const data = await response.json();
    /*ultimately what we want to do is from the client, make a GET request to a route on
    the server, and have that route return all the data from the database.

    this is much simpler, we don't need to explicitly set the method to POST, because the default
    is GET

    and we could just give it the same path we used before, although we could set up a different
    route

    * we can reuse the API route because we used it previously as a POST, so calling fetch with
    a GET to API will be handled in a different function in the server itself

    NOW: We also have to add some native JavaScript DOM manipulation to display the content in the database onto the webpage
    Dan leaves some code to get us started

    */
    for (item of data){
      const root = document.createElement('div');
      const name = document.createElement('div');
      const geo = document.createElement('div');
      const date = document.createElement('div');

      name.textContent = `name: ${item.user}`;
      geo.content = `${item.lat},${item.long}`;
      const dateString = new Date(item.timestamp).toLocaleString();
      /*this is basically taking thatt timestamp, which is basically the # of milliseconds since
      January 1 1970, and converting back into a string*/
      date.textContent = dateString;
      /*so basically all three divs all go inside root*/
      root.append(name,geo,date);
      /*can use append functiona
      -append will actually take multiple elements as arguments and append them all
      */
      document.body.append(root);
    }
    console.log("Data: ",data);

  }//end of getData() function


  </script>

  </body>
</html>
